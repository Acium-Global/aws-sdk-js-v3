import { __awaiter } from "tslib";
import { SignatureV4 } from "./signer";
export const resolveWebSocketConfig = (input) => {
    var _a;
    return ((_a = input.requestHandler.metadata) === null || _a === void 0 ? void 0 : _a.handlerProtocol) !== "websocket"
        ? input
        : Object.assign(Object.assign({}, input), { signer: () => __awaiter(void 0, void 0, void 0, function* () {
                const signerObj = yield input.signer();
                if (validateSigner(signerObj)) {
                    return new SignatureV4({ signer: signerObj });
                }
                throw new Error("Expected SignatureV4 signer, please check the client constructor.");
            }) });
};
const validateSigner = (signer) => 
// We cannot use instanceof here. Because we might import the wrong SignatureV4
// constructor here as multiple version of packages maybe installed here.
signer.constructor.toString().indexOf("SignatureV4") >= 0;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlndXJhdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb25maWd1cmF0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFHQSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBb0J2QyxNQUFNLENBQUMsTUFBTSxzQkFBc0IsR0FBRyxDQUNwQyxLQUFvRCxFQUN2QixFQUFFOztJQUMvQixPQUFBLENBQUEsTUFBQSxLQUFLLENBQUMsY0FBYyxDQUFDLFFBQVEsMENBQUUsZUFBZSxNQUFLLFdBQVc7UUFDNUQsQ0FBQyxDQUFDLEtBQUs7UUFDUCxDQUFDLGlDQUNNLEtBQUssS0FDUixNQUFNLEVBQUUsR0FBUyxFQUFFO2dCQUNqQixNQUFNLFNBQVMsR0FBRyxNQUFNLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztnQkFDdkMsSUFBSSxjQUFjLENBQUMsU0FBUyxDQUFDLEVBQUU7b0JBQzdCLE9BQU8sSUFBSSxXQUFXLENBQUMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztpQkFDL0M7Z0JBQ0QsTUFBTSxJQUFJLEtBQUssQ0FBQyxtRUFBbUUsQ0FBQyxDQUFDO1lBQ3ZGLENBQUMsQ0FBQSxHQUNGLENBQUE7Q0FBQSxDQUFDO0FBRVIsTUFBTSxjQUFjLEdBQUcsQ0FBQyxNQUFXLEVBQTZCLEVBQUU7QUFDaEUsK0VBQStFO0FBQy9FLHlFQUF5RTtBQUN4RSxNQUFNLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBYSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaWduYXR1cmVWNCBhcyBCYXNlU2lnbmF0dXJlVjQgfSBmcm9tIFwiQGF3cy1zZGsvc2lnbmF0dXJlLXY0XCI7XG5pbXBvcnQgeyBQcm92aWRlciwgUmVxdWVzdEhhbmRsZXIsIFJlcXVlc3RTaWduZXIgfSBmcm9tIFwiQGF3cy1zZGsvdHlwZXNcIjtcblxuaW1wb3J0IHsgU2lnbmF0dXJlVjQgfSBmcm9tIFwiLi9zaWduZXJcIjtcblxuZXhwb3J0IGludGVyZmFjZSBXZWJTb2NrZXRJbnB1dENvbmZpZyB7fVxuXG5pbnRlcmZhY2UgUHJldmlvdXNseVJlc29sdmVkIHtcbiAgc2lnbmVyOiBQcm92aWRlcjxSZXF1ZXN0U2lnbmVyPjtcbiAgcmVxdWVzdEhhbmRsZXI6IFJlcXVlc3RIYW5kbGVyPGFueSwgYW55Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXZWJTb2NrZXRSZXNvbHZlZENvbmZpZyB7XG4gIC8qKlxuICAgKiBSZXNvbHZlZCB2YWx1ZSBvZiBpbnB1dCBjb25maWcge0BsaW5rIEF3c0F1dGhJbnB1dENvbmZpZy5zaWduZXJ9XG4gICAqL1xuICBzaWduZXI6IFByb3ZpZGVyPFJlcXVlc3RTaWduZXI+O1xuICAvKipcbiAgICogVGhlIEhUVFAgaGFuZGxlciB0byB1c2UuIEZldGNoIGluIGJyb3dzZXIgYW5kIEh0dHBzIGluIE5vZGVqcy5cbiAgICovXG4gIHJlcXVlc3RIYW5kbGVyOiBSZXF1ZXN0SGFuZGxlcjxhbnksIGFueT47XG59XG5cbmV4cG9ydCBjb25zdCByZXNvbHZlV2ViU29ja2V0Q29uZmlnID0gPFQ+KFxuICBpbnB1dDogVCAmIFdlYlNvY2tldElucHV0Q29uZmlnICYgUHJldmlvdXNseVJlc29sdmVkXG4pOiBUICYgV2ViU29ja2V0UmVzb2x2ZWRDb25maWcgPT5cbiAgaW5wdXQucmVxdWVzdEhhbmRsZXIubWV0YWRhdGE/LmhhbmRsZXJQcm90b2NvbCAhPT0gXCJ3ZWJzb2NrZXRcIlxuICAgID8gaW5wdXRcbiAgICA6IHtcbiAgICAgICAgLi4uaW5wdXQsXG4gICAgICAgIHNpZ25lcjogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNpZ25lck9iaiA9IGF3YWl0IGlucHV0LnNpZ25lcigpO1xuICAgICAgICAgIGlmICh2YWxpZGF0ZVNpZ25lcihzaWduZXJPYmopKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFNpZ25hdHVyZVY0KHsgc2lnbmVyOiBzaWduZXJPYmogfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIFNpZ25hdHVyZVY0IHNpZ25lciwgcGxlYXNlIGNoZWNrIHRoZSBjbGllbnQgY29uc3RydWN0b3IuXCIpO1xuICAgICAgICB9LFxuICAgICAgfTtcblxuY29uc3QgdmFsaWRhdGVTaWduZXIgPSAoc2lnbmVyOiBhbnkpOiBzaWduZXIgaXMgQmFzZVNpZ25hdHVyZVY0ID0+XG4gIC8vIFdlIGNhbm5vdCB1c2UgaW5zdGFuY2VvZiBoZXJlLiBCZWNhdXNlIHdlIG1pZ2h0IGltcG9ydCB0aGUgd3JvbmcgU2lnbmF0dXJlVjRcbiAgLy8gY29uc3RydWN0b3IgaGVyZSBhcyBtdWx0aXBsZSB2ZXJzaW9uIG9mIHBhY2thZ2VzIG1heWJlIGluc3RhbGxlZCBoZXJlLlxuICAoc2lnbmVyLmNvbnN0cnVjdG9yLnRvU3RyaW5nKCkgYXMgc3RyaW5nKS5pbmRleE9mKFwiU2lnbmF0dXJlVjRcIikgPj0gMDtcbiJdfQ==